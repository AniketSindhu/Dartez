parameter (or (address %setTargetContract) (pair %setUserData (string %userAddress) (string %userData))); storage (pair (address %admin) (pair (address %targetContract) (map %user_data string string))); view "getUserData" string string { UNPAIR ; SWAP ; GET 4 ; SWAP ; GET ; IF_NONE { PUSH int 21 ; FAILWITH } {} }; code { UNPAIR ; IF_LEFT { SWAP ; DUP ; DUG 2 ; CAR ; PACK ; SENDER ; PACK ; COMPARE ; EQ ; IF {} { PUSH string "Sender is not admin" ; FAILWITH } ; UPDATE 3 } { SWAP ; DUP ; DUG 2 ; GET 3 ; PACK ; SENDER ; PACK ; COMPARE ; EQ ; IF {} { PUSH string "Sender is not targetContract" ; FAILWITH } ; SWAP ; DUP ; GET 4 ; DUP 3 ; CDR ; SOME ; DIG 3 ; CAR ; UPDATE ; UPDATE 4 } ; NIL operation ; PAIR }