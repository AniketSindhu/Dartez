parameter (or (pair %check_signature (pair (key %public_key) (pair (string %payload) (signature %payload_signature))) (contract %callback bool)) (unit %default)); storage (big_map string bytes); code { NIL operation ; DIG 1 ; UNPAIR ; IF_LEFT { UNPAIR ; UNPAIR ; SWAP ; UNPAIR ; SWAP ; DUP 6 ; DUP 5 ; AMOUNT ; DUP 5 ; PACK ; DUP 5 ; DUP 8 ; CHECK_SIGNATURE ; TRANSFER_TOKENS ; CONS ; DIP { DIG 5 ; DROP } ; DUG 5 ; DROP 4 ; DIG 1 ; PAIR } { DROP ; DIG 1 ; PAIR } }