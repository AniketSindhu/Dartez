parameter (or (unit %default) (contract %get_price nat)); storage (pair (address %oracle) (string %symbol)); code { UNPAIR ; IF_LEFT { DROP ; NIL operation ; SENDER ; CONTRACT unit ; IF_NONE { PUSH int 212 ; FAILWITH } {} ; AMOUNT ; UNIT ; TRANSFER_TOKENS ; CONS } { AMOUNT ; PUSH mutez 0 ; COMPARE ; EQ ; IF {} { AMOUNT ; FAILWITH } ; NIL operation ; SWAP ; PUSH mutez 0 ; PUSH nat 1 ; DIG 4 ; DUP ; CAR ; SWAP ; DUP ; DUG 6 ; CDR ; VIEW "get_price" nat ; IF_NONE { PUSH int 502 ; FAILWITH } {} ; MUL ; TRANSFER_TOKENS ; CONS } ; PAIR }